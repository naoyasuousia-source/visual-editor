<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>AI-Link Editor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=BIZ+UDMincho:wght@400;700&family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP:wght@400;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="content.css">
  <link rel="stylesheet" href="ui.css">
  <link rel="stylesheet" href="ui_word_mode.css">
  <script src="mammoth/mammoth.browser.min.js"></script>
</head>

<body>

  <div id="left">
    <div id="toolbar">
      <div class="app-logo">
        <img src="image/logo-himawari.png" alt="Logo">
      </div>
      <div class="file-menu">
        <button type="button" class="file-trigger">ファイル ▾</button>
        <div class="file-dropdown" role="menu" aria-label="File options">
          <button type="button" data-action="save">保存<span class="shortcut-key">ctrl+S</span></button>
          <button type="button" data-action="save-as">名前を付けて保存</button>
          <button type="button" data-action="overwrite">上書き保存<span class="shortcut-key">ctrl+S</span></button>
          <button type="button" data-action="open-html">HTMLファイルを開く<span class="shortcut-key">ctrl+O</span></button>
          <button type="button" data-action="open-docx" class="word-only">Wordファイル(docx)を開く</button>
          <button type="button" data-action="print">PDFとして出力</button>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">ハイパーリンク</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="add-link-destination">リンク先に追加</button>
              <button type="button" data-action="create-link">リンクを生成</button>
              <button type="button" data-action="remove-link">リンクを削除</button>
            </div>
          </div>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">画像を挿入</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="insert-image-dropbox">dropboxから挿入</button>
              <button type="button" data-action="insert-image-web">web上の画像を挿入</button>
            </div>
          </div>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">余白</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="page-margin" data-size="s">S</button>
              <button type="button" data-action="page-margin" data-size="m">M</button>
              <button type="button" data-action="page-margin" data-size="l">L</button>
            </div>
          </div>
        </div>
      </div>
      <div class="view-menu">
        <button type="button" class="view-trigger">表示 ▾</button>
        <div class="view-dropdown" role="menu" aria-label="View options">
          <label class="menu-item-label">
            <input type="checkbox" data-action="toggle-page-numbers" checked> ページ番号
          </label>
          <label class="menu-item-label">
            <input type="checkbox" data-action="toggle-para-numbers" checked> 段落番号
          </label>
        </div>
      </div>
      <div class="word-only">
        <label
          style="font-size: 13px; display: flex; align-items: center; gap: 4px; cursor: pointer; white-space: nowrap;">
          <input type="checkbox" id="word-toggle-para-numbers" checked> 段落番号
        </label>
      </div>
      <button type="button" data-action="bold">B</button>
      <button type="button" data-action="italic">I</button>
      <button type="button" data-action="underline">U</button>
      <button type="button" data-action="strike">S</button>

      <div class="highlight-control">
        <button type="button" data-action="highlight" aria-expanded="false" title="ハイライト">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="m9 11-6 6v3h9l3-3" />
            <path d="m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4" />
            <path d="M2 21h20" stroke="#FFD700" stroke-width="3" />
          </svg>
        </button>
        <div class="highlight-palette" role="group" aria-label="ハイライトカラー">
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#FFFF00"
            style="color:#FFFF00" title="黄色" aria-label="黄色"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#FFB7B7"
            style="color:#FFB7B7" title="薄ピンク" aria-label="薄ピンク"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#B7E1FF"
            style="color:#B7E1FF" title="薄青" aria-label="薄青"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#C4F0C5"
            style="color:#C4F0C5" title="薄緑" aria-label="薄緑"></button>
          <button type="button" class="highlight-reset-button" data-action="highlight-reset"
            title="ハイライトを取り消す">取消</button>
        </div>
      </div>
      <button type="button" data-action="superscript" title="上付き"><svg viewBox="0 0 24 24" width="20" height="20"
          fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 20L14 8M14 20L5 8" /><text x="15" y="8" font-size="11" stroke="none" fill="currentColor"
            font-weight="bold">2</text>
        </svg></button>
      <button type="button" data-action="subscript" title="下付き"><svg viewBox="0 0 24 24" width="20" height="20"
          fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 18L14 6M14 18L5 6" /><text x="15" y="23" font-size="11" stroke="none" fill="currentColor"
            font-weight="bold">2</text>
        </svg></button>
      <div class="font-chooser" id="font-chooser">
        <button type="button" class="font-chooser-trigger" aria-haspopup="true" aria-expanded="false">Font ▾</button>
        <div class="font-chooser-panel" role="menu" aria-label="フォント操作">
          <div class="font-submenu" data-submenu="block-element">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="ブロック要素">
              <span class="current-block-label" style="font-size: 12px; margin-right: 4px;">本文</span>
              <svg viewBox="0 0 24 24" width="10" height="10" fill="currentColor">
                <path d="M7 10l5 5 5-5z" />
              </svg>
            </button>
            <div class="font-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h1"
                  title="見出し１">見出し１</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h2"
                  title="見出し２">見出し２</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h3"
                  title="見出し３">見出し３</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="p"
                  title="本文">本文</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h6"
                  title="サブテキスト">サブテキスト</button>
              </div>
            </div>
          </div>
          <div class="font-submenu" data-submenu="font-color">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="フォントカラー">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2 5 17h2l1-4h8l1 4h2L12 2zm-3 11 3-8 3 8H9z" />
                <path d="M2 21h20" stroke-width="3" stroke="#D92C2C" />
              </svg>
            </button>
            <div class="font-submenu-panel" role="menu">
              <div class="color-palette" role="group" aria-label="フォントカラー">
                <button type="button" class="color-swatch-button" data-action="font-color-default" title="デフォルトカラー"
                  aria-label="デフォルトカラー" style="color:#000000"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#D92C2C"
                  style="color:#D92C2C" title="#D92C2C" aria-label="#D92C2C"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#E67F22"
                  style="color:#E67F22" title="#E67F22" aria-label="#E67F22"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#2E86C1"
                  style="color:#2E86C1" title="#2E86C1" aria-label="#2E86C1"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#1F618D"
                  style="color:#1F618D" title="#1F618D" aria-label="#1F618D"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#17A589"
                  style="color:#17A589" title="#17A589" aria-label="#17A589"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#7D3C98"
                  style="color:#7D3C98" title="#7D3C98" aria-label="#7D3C98"></button>
              </div>
            </div>
          </div>
          <div class="font-submenu" data-submenu="font-family">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="フォントファミリー">
              <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5">
                <!-- Sans-serif A (Back) -->
                <text x="10" y="20" font-family="sans-serif" font-size="20" font-weight="bold" fill="currentColor"
                  stroke="none" opacity="0.4">A</text>
                <!-- Serif A (Front) -->
                <text x="2" y="20" font-family="serif" font-size="20" font-weight="bold" fill="currentColor"
                  stroke="none">A</text>
              </svg>
            </button>
            <div class="font-submenu-panel" role="menu">
              <div class="font-family-list">
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Yu Gothic', '游ゴシック体', sans-serif"
                  style="font-family: 'Yu Gothic', '游ゴシック体', sans-serif;">游ゴシック</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Yu Mincho', '游明朝', serif" style="font-family: 'Yu Mincho', '游明朝', serif;">游明朝</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Meiryo', 'メイリオ', sans-serif"
                  style="font-family: 'Meiryo', 'メイリオ', sans-serif;">メイリオ</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'BIZ UDGothic', 'BIZ UDゴシック', sans-serif"
                  style="font-family: 'BIZ UDGothic', 'BIZ UDゴシック', sans-serif;">BIZ UDゴシック</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'BIZ UDMincho', 'BIZ UD明朝', serif"
                  style="font-family: 'BIZ UDMincho', 'BIZ UD明朝', serif;">BIZ UD明朝</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Noto Sans JP', sans-serif" style="font-family: 'Noto Sans JP', sans-serif;">Noto Sans
                  JP</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Noto Serif JP', serif" style="font-family: 'Noto Serif JP', serif;">Noto Serif
                  JP</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Arial', sans-serif" style="font-family: 'Arial', sans-serif;">Arial</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Times New Roman', serif" style="font-family: 'Times New Roman', serif;">Times New
                  Roman</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Courier New', monospace" style="font-family: 'Courier New', monospace;">Courier
                  New</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="word-only">
        <select id="word-block-selector" class="word-block-selector" title="ブロック要素を選択">
          <option value="p">本文</option>
          <option value="h1">見出し１</option>
          <option value="h2">見出し２</option>
          <option value="h3">見出し３</option>
          <option value="h6">サブテキスト</option>
        </select>
      </div>
      <div class="paragraph-chooser" id="paragraph-chooser">
        <button type="button" class="paragraph-trigger" aria-haspopup="true" aria-expanded="false">段落スタイル ▾</button>
        <div class="paragraph-panel" role="menu" aria-label="段落スタイル">
          <div class="paragraph-submenu" data-submenu="align">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="配置"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                stroke-width="2">
                <line x1="4" y1="6" x2="20" y2="6" />
                <line x1="4" y1="12" x2="14" y2="12" />
                <line x1="4" y1="18" x2="20" y2="18" />
              </svg></button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="align-buttons">
                <button type="button" class="align-icon-button" data-action="align-left" title="左揃え" aria-label="左揃え">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="15" y1="10" x2="3" y2="10"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="17" y1="18" x2="3" y2="18"></line>
                  </svg>
                </button>
                <button type="button" class="align-icon-button" data-action="align-center" title="中央揃え"
                  aria-label="中央揃え">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="17" y1="10" x2="7" y2="10"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="17" y1="18" x2="7" y2="18"></line>
                  </svg>
                </button>
                <button type="button" class="align-icon-button" data-action="align-right" title="右揃え" aria-label="右揃え">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="21" y1="6" x2="3" y2="6"></line>
                    <line x1="21" y1="10" x2="9" y2="10"></line>
                    <line x1="21" y1="14" x2="3" y2="14"></line>
                    <line x1="21" y1="18" x2="7" y2="18"></line>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="spacing">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="段落下の余白"><svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M4 6h16M4 18h16M12 9v6M9 12l3 3 3-3" />
              </svg></button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="xs"
                  title="XS">XS</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="s"
                  title="S">S</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="m"
                  title="M">M</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="l"
                  title="L">L</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="xl"
                  title="XL">XL</button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="line-height">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="行間"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M11 6h11v2H11zm0 5h11v2H11zm0 5h11v2H11zM6 3L3 6h2v12H3l3 3 3-3H7V6h2z" />
              </svg></button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="line-height" data-size="s"
                  title="S">S</button>
                <button type="button" class="spacing-button" data-action="line-height" data-size="m"
                  title="M">M</button>
                <button type="button" class="spacing-button" data-action="line-height" data-size="l"
                  title="L">L</button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="indent">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true" aria-expanded="false"
              title="インデント"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                <path d="M3 4h18v2H3zm0 14h18v2H3zm8-9h10v2H11zm0 4h10v2H11zM5 8v8l5-4z" />
              </svg></button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="indent">＋</button>
                <button type="button" class="spacing-button" data-action="outdent">ー</button>
              </div>
              <div class="indent-option">
                <label>
                  <input type="checkbox" data-action="hanging-indent" disabled> ぶら下げ
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
      <button type="button" data-action="add-page">+Page</button>
      <button type="button" data-action="remove-page">-Page</button>
      <div style="flex-grow: 1;"></div>
      <div class="zoom-controls">
        <button type="button" data-action="zoom-out" title="縮小">－</button>
        <span id="zoom-level-display">100%</span>
        <button type="button" data-action="zoom-in" title="拡大">＋</button>
      </div>
      <div class="jump-widget">
        <label for="toolbar-jump-input" class="standard-only">ジャンプ機能　[ ctrl+J ]</label>
        <label for="toolbar-jump-input-word" class="word-only">ジャンプ機能　[ ctrl+J ]</label>
        <input type="text" id="toolbar-jump-input" class="standard-only" placeholder='（例：1-1　または　"本文中に含まれる文字列"）'
          title="段落番号(例:1-1)または検索したい文字列を入力してください">
        <input type="text" id="toolbar-jump-input-word" class="word-only" placeholder='（例：15　または　"本文中に含まれる文字列"）'
          title="段落番号(例:15)または検索したい文字列を入力してください">
      </div>
      <button type="button" id="mode-switch" title="編集モード切替">
        <span class="mode-text-std">標準モードに切替</span>
        <span class="mode-text-word">Word互換モードに切替</span>
      </button>
      <button type="button" id="help-trigger" title="使い方・ヒント" aria-label="ヘルプ">
        <svg viewBox="0 0 24 24" width="23" height="23" fill="none" stroke="currentColor" stroke-width="1.25"
          stroke-linecap="round" stroke-linejoin="round" style="display: block;">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
          <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
      </button>
      <button type="button" id="donate-trigger" title="開発を応援する">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
          <path
            d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
        </svg>
        <span>開発を応援</span>
      </button>
    </div>
    <input type="file" id="open-file-input" accept=".html,text/html" style="display:none" />
    <div id="workspace">
      <div id="page-navigator"></div>
      <div id="sidebar-toggle-overlay">
        <button id="sidebar-toggle-btn">サムネイル ON/OFF</button>
      </div>
      <div id="pages-container">
        <!-- 初期ページ -->
        <section class="page" data-page="1">
          <div class="page-inner" contenteditable="true">
            <p><br></p>
          </div>
        </section>
        <div id="ai-image-index" style="display:none"></div>
      </div>
    </div>




    <div id="image-context-menu" class="image-context-menu" role="menu">
      <div class="image-context-dropdown">
        <button type="button" class="image-context-trigger" aria-haspopup="menu" aria-expanded="false">サイズ</button>
        <div class="image-context-submenu" role="menu">
          <button type="button" data-action="image-size" data-size="xs">XS</button>
          <button type="button" data-action="image-size" data-size="s">S</button>
          <button type="button" data-action="image-size" data-size="m">M</button>
          <button type="button" data-action="image-size" data-size="l">L</button>
          <button type="button" data-action="image-size" data-size="xl">XL</button>
        </div>
      </div>
      <button type="button" data-action="image-border">枠線</button>
      <button type="button" data-action="image-title">タイトル</button>
      <button type="button" data-action="image-caption">キャプション</button>
      <button type="button" data-action="image-tag">タグ</button>
    </div>

    <dialog id="paragraph-jump-dialog">
      <form method="dialog" class="dialog-form">
        <p>段落へジャンプ</p>
        <label class="standard-only">
          段落番号 (例: 1-1):
          <input type="text" id="paragraph-jump-input" placeholder="p-n">
        </label>
        <label class="word-only">
          段落番号 (例: 15):
          <input type="text" id="paragraph-jump-input-word" placeholder="p-n">
        </label>
        <div class="dialog-actions" style="display:none"></div>
      </form>
    </dialog>

    <dialog id="image-title-dialog" aria-labelledby="image-title-dialog-label">
      <form method="dialog" aria-describedby="image-title-dialog-description">
        <p id="image-title-dialog-label">画像タイトル</p>
        <label for="image-title-input">
          タイトル
          <input type="text" id="image-title-input" name="image-title-input" placeholder="タイトルを入力" />
        </label>
        <fieldset id="image-title-dialog-description">
          <legend>フォントサイズ</legend>
          <label>
            <input type="radio" name="image-title-font-size" value="default" checked />
            本文サイズ
          </label>
          <label>
            <input type="radio" name="image-title-font-size" value="mini" />
            サブテキスト
          </label>
        </fieldset>
        <div class="dialog-actions">
          <button type="button" data-action="cancel-image-title">キャンセル</button>
          <button type="button" data-action="apply-image-title">適用</button>
        </div>
      </form>
    </dialog>

    <dialog id="image-caption-dialog" aria-labelledby="image-caption-dialog-label">
      <form method="dialog">
        <p id="image-caption-dialog-label">画像キャプション</p>
        <label for="image-caption-input">
          キャプション
          <textarea id="image-caption-input" name="image-caption-input" placeholder="キャプションを入力" rows="5"
            style="width: 100%; resize: vertical;"></textarea>
        </label>
        <div class="dialog-actions">
          <button type="button" data-action="cancel-image-caption">キャンセル</button>
          <button type="button" data-action="apply-image-caption">適用</button>
        </div>
      </form>
    </dialog>

    <dialog id="image-tag-dialog" aria-labelledby="image-tag-dialog-label">
      <form method="dialog">
        <p id="image-tag-dialog-label">画像タグ</p>
        <label for="image-tag-input">
          タグ (カンマ区切り)
          <input type="text" id="image-tag-input" name="image-tag-input" placeholder="A,B,C" />
        </label>
        <div class="dialog-actions">
          <button type="button" data-action="cancel-image-tag">キャンセル</button>
          <button type="button" data-action="apply-image-tag">適用</button>
        </div>
      </form>
    </dialog>

    <dialog id="help-dialog" aria-labelledby="help-dialog-label">
      <form method="dialog">
        <div class="hint-header">
          <h1 id="help-dialog-label">真のAI編集アシスト体験へ</h1>
          <button type="submit" class="close-button" aria-label="閉じる">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <div class="hint-body">
          <section class="hint-section">
            <p class="hint-desc" style="text-align: left;">
              生成AIがdocx・pdfのページ区切りや段落番号を把握できず、快適な編集アシストができないという問題を解決。<br>
              本エディターで保存したHTMLファイルをアップロードすると、ページ・段落構成を完全に生成AIと共有できます。
              これにより、AIアシストによる、快適でスピーディーな編集が可能になります。
            </p>
          </section>

          <section class="hint-section">
            <h2 class="hint-title">生成AI連携方法</h2>
            <div class="hint-workflow-container">
              <img src="image/work-flow.png" alt="生成AI連携方法ワークフロー" class="hint-workflow-img">
            </div>
          </section>

          <section class="hint-section standard-only">
            <h2 class="hint-title">PDF出力</h2>
            <div class="hint-pdf-box">
              <div class="pdf-icon-container" title="PDF出力">
                <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="#0891b2" stroke-width="1.5"
                  stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="12" y1="18" x2="12" y2="12"></line>
                  <polyline points="9 15 12 18 15 15"></polyline>
                </svg>
              </div>
              <p class="hint-desc" style="text-align: left;">
                エディタ上のレイアウトを維持したPDF出力が可能です。印刷ダイアログで<span
                  style="color: #dc2626; font-weight: bold;">「PDFに保存」</span>を選択し、必ず<span
                  style="color: #dc2626; font-weight: bold;">「背景のグラフィック」</span>をONにして出力してください。
              </p>
            </div>
          </section>

          <section class="hint-section word-only block-layout">
            <div class="word-hint-container">
              <div class="word-hint-title-group">
                <h2 class="hint-title" style="white-space: nowrap;">Word互換機能</h2>
                <div class="pdf-icon-container" title="Word互換">
                  <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="#0891b2" stroke-width="1.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M9 12h6"></path>
                    <path d="M9 16h6"></path>
                  </svg>
                </div>
              </div>
              <div class="word-hint-desc-group">
                <p class="hint-desc" style="text-align: left;">
                  Wordへの貼り付けは、エディタ上で<span style="color: #dc2626; font-weight: bold;">Ctrl+A →
                    Ctrl+C</span>を行い、Word側で<span style="color: #dc2626; font-weight: bold;">Ctrl+V</span>で貼り付けてください。<br>
                  Wordファイルを読み込む場合は、「Wordファイル(docx)を開く」メニューからインポートしてください。
                </p>
              </div>
            </div>
          </section>
        </div>

        <div class="hint-footer">
          <div class="hint-links">
            <a href="#" data-action="sub-help">利用規約</a>
            <a href="#" data-action="sub-help">プライバシーポリシー</a>
            <a href="#" data-action="sub-help">お問い合わせ</a>
            <a href="#" data-action="sub-help">特定商取引法に基づく表記</a>
          </div>
          <p class="copyright-text">&copy; 2025 AI-Link Editor</p>
        </div>
      </form>
    </dialog>

    <dialog id="sub-help-dialog" aria-labelledby="sub-help-dialog-label">
      <form method="dialog">
        <div class="hint-header">
          <h1 id="sub-help-dialog-label">詳細情報</h1>
          <button type="submit" class="close-button" aria-label="閉じる">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round"
              stroke-linejoin="round">
              <path d="M20 4L4 20M4 4l16 16"></path>
            </svg>
          </button>
        </div>
        <div class="hint-body" id="sub-help-content">
          <p>こちらには今後、固有の内容が追加される予定です。</p>
        </div>
      </form>
    </dialog>



    <dialog id="donate-dialog" aria-labelledby="donate-dialog-label">
      <form method="dialog">
        <div class="hint-header">
          <h1 id="donate-dialog-label">AI-Link Editorを応援しませんか？</h1>
          <button type="submit" class="close-button" aria-label="閉じる">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="hint-body">
          <p class="donate-intro">
            いつもご利用ありがとうございます！
            このAI-Link Editorは、「快適なAIアシスト編集環境を提供したい」という想いから、個人で開発・運営しています。
            開発経費や維持費は皆様の温かいご支援で支えられており、おかげで「全機能・完全無料」を継続できています。
            もしこのツールがあなたの役に立ったら、エディタを気に入っていただけたら、開発の継続を応援していただけると、サービス改善・向上の励みになります！
          </p>

          <div class="thanks-box">
            <div class="thanks-header">
              <h2 class="thanks-title">Special Thanks</h2>
              <p class="thanks-note">（ご支援いただいた方は、感謝を込めてお名前を掲載させていただきます！ ※決済画面の入力欄に、ご希望のハンドルネームをご記入ください。）</p>
            </div>
            <div class="thanks-names">
              <span class="thanks-name">ha-chan 様</span>
            </div>
          </div>

          <div class="donate-actions">
            <a href="https://donate.stripe.com/28E5kFakIfEre910Z01sQ00" target="_blank" class="donate-button">
              <span class="donate-button-main">500円〜（コーヒー1杯分程度）寄付を行う</span>
              <span class="donate-button-sub">※安全な決済システム（Stripe）へ移動します。</span>
            </a>
          </div>

          <div class="profile-section">
            <h2 class="profile-title"><span class="icon">👤</span>制作者プロフィール</h2>
            <p class="profile-text">
              1999年生まれ。埼玉県出身。東京大学農学部卒。在学中に自律神経失調症を患い、卒業後は「東大卒ニート」として療養生活を送る。現在は回復し、フリーランスのボイストレーナーをしながら、AIを駆使した開発に挑戦中。
              無類のyasu（Acid Black Cherry）好き。人生のテーマは「本質に向き合うこと」。
            </p>
          </div>

          <div class="story-section">
            <h2 class="story-title"><span class="icon">💡</span>開発の経緯</h2>
            <p class="story-text">
              理系出身なのに、突然「経済学を学びたい！」と思い立ったのが始まりでした。
              ChatGPTと協力してまとめテキストを作ろうとしたのですが、既存のWordやPDFではAIが「何ページ目のどこを編集しているか」を正確に把握できず、スムーズに連携できないことにイライラ……。
              「だったら、AIが迷わない専用エディタを自分で作ればいいじゃん！」と決意。
              プログラミング未経験でしたが、ChatGPTやGeminiを相棒に、二人三脚でこのアプリを形にしました。
            </p>
          </div>
        </div>
      </form>
    </dialog>

    <dialog id="browser-warning-dialog" aria-labelledby="browser-warning-label">
      <form method="dialog">
        <p id="browser-warning-label"
          style="color: #d9534f; display: flex; align-items: center; justify-content: center; gap: 8px;">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          推奨環境のお知らせ
        </p>
        <div class="dialog-content" style="text-align: center; line-height: 1.6;">
          <p>このツールはPC環境のGoogle Chrome・Microsoft Edgeに最適化されています。<br>他環境・他ブラウザでは正しく動作しない場合があります。</p>
        </div>
        <div class="dialog-actions" style="justify-content: center;">
          <button type="submit">閉じる</button>
        </div>
      </form>
    </dialog>

    <script type="module">
      import { initEditor } from "./dist/main.js";
      initEditor();
    </script>


</body>

</html>