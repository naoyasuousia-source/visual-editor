<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Multi-page A4 Editor</title>
  <style>
    :root {
      --page-margin: 17mm;
      --para-number-left: 6mm;
      --editor-font-family: inherit;
    }

    body {
      display: flex;
      gap: 16px;
      margin: 0;
      padding: 16px;
      font-family: sans-serif;
      background: #ddd;
      box-sizing: border-box;
    }

    #ai-image-index {
      display: none;
    }

    #left {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    #toolbar {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    #toolbar button {
      padding: 4px 10px;
      margin: 0;
      cursor: pointer;
    }

    .file-menu {
      position: relative;
      display: inline-flex;
      align-items: stretch;
    }

    .file-menu .file-trigger {
      margin-right: 0;
    }

    .file-dropdown {
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      display: none;
      flex-direction: column;
      min-width: 120px;
      z-index: 10;
    }

    .file-dropdown.open {
      display: flex;
    }

    .file-dropdown button {
      margin: 0;
      width: 100%;
      border: none;
      border-bottom: 1px solid #eee;
      background: none;
      text-align: left;
    }

    .file-dropdown button:last-child {
      border-bottom: 0;
    }

    .nested-dropdown {
      position: relative;
      display: flex;
      align-items: stretch;
    }

    .nested-trigger {
      border: none;
      border-bottom: 0;
      background: none;
      padding: 4px 10px;
      margin: 0;
      width: 100%;
      text-align: left;
    }

    .nested-trigger::after {
      content: '▸';
      float: right;
    }

    .nested-dropdown-menu {
      position: absolute;
      top: 0;
      left: 100%;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      min-width: 140px;
      z-index: 12;
    }

    .nested-dropdown.open .nested-dropdown-menu {
      display: flex;
    }

    .nested-dropdown-menu button {
      border-bottom: 1px solid #eee;
      border-radius: 0;
      padding: 4px 10px;
    }

    .nested-dropdown-menu button:last-child {
      border-bottom: 0;
    }

    .image-context-menu {
      position: fixed;
      display: none;
      flex-direction: column;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
      padding: 4px 0;
      min-width: 160px;
      z-index: 20;
    }

    .image-context-menu.open {
      display: flex;
    }

    .image-context-menu button {
      background: none;
      border: none;
      padding: 6px 16px;
      text-align: left;
      width: 100%;
      cursor: pointer;
    }

    .image-context-menu button:hover {
      background: #f0f0f0;
    }

    .image-context-dropdown {
      position: relative;
    }

    .image-context-trigger {
      width: 100%;
      background: none;
      border: none;
      padding: 6px 16px;
      text-align: left;
      cursor: pointer;
    }

    .image-context-trigger::after {
      content: '▾';
      float: right;
    }

    .image-context-dropdown .image-context-submenu {
      position: absolute;
      top: 0;
      left: 100%;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      display: none;
      flex-direction: column;
      min-width: 140px;
      z-index: 22;
    }

    .image-context-dropdown.open .image-context-submenu {
      display: flex;
    }

    .image-context-submenu button {
      padding: 6px 12px;
      border: none;
      background: none;
      text-align: left;
      width: 100%;
    }

    .image-context-submenu button:hover {
      background: #f0f0f0;
    }

    .page-inner img {
      display: block;
      max-width: 100%;
      height: auto;
      margin: 0.6em 0;
    }

    .img-xs {
      width: 20%;
    }

    .img-s {
      width: 35%;
    }

    .img-m {
      width: 50%;
    }

    .img-l {
      width: 65%;
    }

    .img-xl {
      width: 85%;
    }

    #pages-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
      overflow-y: auto;
    }

    /* 1ページ（A4枠） */
    section.page {
      position: relative;
      width: min(100%, 60vw);
      aspect-ratio: 210 / 297;
      /* A4比率 */
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 0 8px rgba(0, 0, 0, .15);
      box-sizing: border-box;
      overflow: hidden;
    }

    section.page::after {
      content: attr(data-page);
      position: absolute;

      /* 下中央へ移動 */
      left: 50%;
      bottom: 6mm;
      transform: translateX(-50%);

      font-size: 11px;
      color: #666;
    }


    /* ページ内の編集領域 */
    .page-inner {
      width: 100%;
      height: 100%;
      box-sizing: border-box;
      padding: var(--page-margin);
      position: relative;
      overflow-y: auto;
      outline: none;
      font-family: var(--editor-font-family, inherit);
    }

    .page-inner .figure-inline {
      display: block;
      width: 100%;
      box-sizing: border-box;
      text-align: center;
    }

    .page-inner .figure-inline img {
      display: inline-block;
      max-width: 100%;
      height: auto;
      margin: 0.6em auto;
    }

    .page-inner .figure-title {
      display: inline-block;
      margin-top: 0.35em;
      text-align: center;
    }

    .page-inner .caret-slot {
      display: inline;
      user-select: none;
      pointer-events: none;
    }


    .page-inner p,
    .page-inner h1,
    .page-inner h2,
    .page-inner h3,
    .page-inner h4,
    .page-inner h5,
    .page-inner h6 {
      margin: 0 0 1em;
      position: relative;
      padding-left: 0;
    }

    .page-inner p[data-para]::before,
    .page-inner h1[data-para]::before,
    .page-inner h2[data-para]::before,
    .page-inner h3[data-para]::before,
    .page-inner h4[data-para]::before,
    .page-inner h5[data-para]::before,
    .page-inner h6[data-para]::before {
      content: "[" attr(data-para) "]";
      position: absolute;
      /* 
         以前は left: calc(var(--para-number-left) - var(--page-margin)); でしたが、
         余白が変わっても本文からの距離を一定にするため、固定値にします。
         Mサイズ(余白17mm, 番号位置6mm)の差分である -11mm を基準とします。
      */
      left: -11mm;
      top: 0.25em;
      width: 2.4rem;
      text-align: right;
      color: #555;
      font-size: 0.75rem;
      font-weight: 400;
      line-height: 1;
      transform: none;
      user-select: none;
      pointer-events: none;
    }

    /* ぶら下げインデント修正 */
    .page-inner .hanging-indent {
      /* 
          1行目を1文字分(約1em)左に突き出す設定。
          text-indentをマイナスにし、1行目を左へずらす。
       */
      text-indent: -1em;
    }

    /* 現在アクティブなページの枠を少し強調 */
    section.page.active {
      border-color: #337ab7;
      box-shadow: 0 0 10px rgba(51, 122, 183, 0.6);
    }

    #source {
      flex: 1;
      height: 100vh;
      box-sizing: border-box;
      font-family: monospace;
      font-size: 12px;
      white-space: pre-wrap;
    }

    .page-inner .indent-1 {
      padding-left: 36pt;
    }

    .page-inner .indent-2 {
      padding-left: 72pt;
    }

    .page-inner .indent-3 {
      padding-left: 108pt;
    }

    .page-inner .indent-4 {
      padding-left: 144pt;
    }

    .page-inner .indent-5 {
      padding-left: 180pt;
    }

    /* Highlight palette control */
    .highlight-control {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
    }

    .highlight-control .highlight-palette {
      display: none;
      margin-top: 4px;
      gap: 4px;
      flex-wrap: wrap;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .highlight-control.is-open .highlight-palette {
      display: flex;
    }

    .highlight-color-button {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: 1px solid #999;
      padding: 0;
      cursor: pointer;
      background: transparent;
      position: relative;
    }

    .highlight-color-button::after {
      content: '';
      position: absolute;
      inset: 2px;
      border-radius: 2px;
      background: currentColor;
    }

    .highlight-color-button:focus-visible,
    .highlight-color-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    .highlight-reset-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 28px;
      padding: 0 10px;
      border-radius: 4px;
      border: 1px solid #999;
      background: #f5f5f5;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .highlight-reset-button:focus-visible,
    .highlight-reset-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    .font-chooser {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .font-chooser-trigger {
      padding: 4px 10px;
      margin: 0;
      border: 1px solid #999;
      border-radius: 4px;
      background: #fff;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .font-chooser-panel {
      display: none;
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      padding: 8px;
      gap: 8px;
      flex-direction: column;
      min-width: 220px;
      z-index: 15;
    }

    .font-chooser.is-open .font-chooser-panel {
      display: flex;
    }

    .font-submenu {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .font-submenu-trigger {
      width: 100%;
      border: 1px solid #999;
      border-radius: 4px;
      background: #f9f9f9;
      padding: 6px 10px;
      cursor: pointer;
      text-align: left;
      font-size: 0.85rem;
    }

    .font-submenu-trigger::after {
      content: '▾';
      float: right;
    }

    .font-submenu.is-open .font-submenu-trigger::after {
      content: '▴';
    }

    .font-submenu-panel {
      display: none;
      flex-direction: column;
      gap: 6px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #fff;
      box-shadow: inset 0 0 0 1px #eee;
    }

    .font-submenu.is-open .font-submenu-panel {
      display: flex;
    }

    .font-family-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .font-family-option {
      border: 1px solid #999;
      border-radius: 4px;
      background: #f9f9f9;
      padding: 6px 10px;
      text-align: left;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .font-family-option:hover {
      background: #ececec;
    }

    .font-family-placeholder {
      color: #777;
      font-size: 0.85rem;
    }

    .color-palette {
      display: flex;
      margin-top: 4px;
      gap: 4px;
      flex-wrap: wrap;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .color-swatch-button {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: 1px solid #999;
      padding: 0;
      cursor: pointer;
      background: transparent;
      position: relative;
    }

    .color-swatch-button::after {
      content: '';
      position: absolute;
      inset: 2px;
      border-radius: 2px;
      background: currentColor;
    }

    .color-swatch-button:focus-visible,
    .color-swatch-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    .color-default-button {
      height: 28px;
      padding: 0 10px;
      border-radius: 4px;
      border: 1px solid #999;
      background: #f5f5f5;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .color-default-button:focus-visible,
    .color-default-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    /* Inline highlight spans mimic marker padding */
    .inline-highlight {
      display: inline-block;
      padding: 0;
      border-radius: 2px;
      line-height: 1.2;
      box-decoration-break: clone;
      -webkit-box-decoration-break: clone;
    }

    .inline-color {
      display: inline-block;
      line-height: 1.2;
      box-decoration-break: clone;
      -webkit-box-decoration-break: clone;
    }

    .inline-tab {
      display: inline-block;
      width: var(--tab-width, 0px);
      height: 1px;
      pointer-events: auto;
      line-height: 0;
      font-size: 0;
      overflow: hidden;
      vertical-align: baseline;
    }

    .paragraph-chooser {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .paragraph-trigger {
      padding: 4px 10px;
      margin: 0;
      border: 1px solid #999;
      border-radius: 4px;
      background: #fff;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .paragraph-panel {
      display: none;
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      background: #fff;
      border: 1px solid #aaa;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      padding: 8px;
      gap: 8px;
      flex-direction: column;
      min-width: 220px;
      z-index: 15;
    }

    .paragraph-chooser.is-open .paragraph-panel {
      display: flex;
    }

    .paragraph-submenu {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .paragraph-submenu-trigger {
      width: 100%;
      border: 1px solid #999;
      border-radius: 4px;
      background: #f9f9f9;
      padding: 6px 10px;
      cursor: pointer;
      text-align: left;
      font-size: 0.85rem;
    }

    .paragraph-submenu-trigger::after {
      content: '▾';
      float: right;
    }

    .paragraph-submenu.is-open .paragraph-submenu-trigger::after {
      content: '▴';
    }

    .paragraph-submenu-panel {
      display: none;
      flex-direction: column;
      gap: 6px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #fff;
      box-shadow: inset 0 0 0 1px #eee;
    }

    .paragraph-submenu.is-open .paragraph-submenu-panel {
      display: flex;
    }

    .align-buttons {
      display: flex;
      gap: 6px;
    }

    .align-icon-button {
      width: 40px;
      height: 28px;
      border-radius: 4px;
      border: 1px solid #999;
      background: #fff;
      cursor: pointer;
      font-size: 0.9rem;
    }

    .align-icon-button:focus-visible,
    .align-icon-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    .spacing-buttons {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .spacing-button {
      width: 40px;
      height: 28px;
      border-radius: 4px;
      border: 1px solid #999;
      background: #fff;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .spacing-button:focus-visible,
    .spacing-button:hover {
      outline: 2px solid #333;
      outline-offset: 2px;
    }

    .inline-align {
      display: inline-block;
      width: 100%;
      box-sizing: border-box;
    }

    .inline-align-left {
      text-align: left;
    }

    .inline-align-center {
      text-align: center;
    }

    .inline-align-right {
      text-align: right;
    }

    .page-inner p.inline-spacing-xs,
    .page-inner .inline-align.inline-spacing-xs {
      margin-bottom: 4px;
    }

    .page-inner p.inline-spacing-s,
    .page-inner .inline-align.inline-spacing-s {
      margin-bottom: 12px;
    }

    .page-inner p.inline-spacing-m,
    .page-inner .inline-align.inline-spacing-m {
      margin-bottom: 20px;
    }

    .page-inner p.inline-spacing-l,
    .page-inner .inline-align.inline-spacing-l {
      margin-bottom: 28px;
    }

    .page-inner p.inline-spacing-xl,
    .page-inner .inline-align.inline-spacing-xl {
      margin-bottom: 36px;
    }

    .page-inner {
      line-height: 1.5;
    }

    .page-inner.line-height-s {
      line-height: 1.2;
    }

    .page-inner.line-height-l {
      line-height: 1.8;
    }

    .mini-text {
      font-size: 8pt;
    }

    dialog#image-title-dialog {
      border: 1px solid #999;
      border-radius: 8px;
      padding: 16px;
      background: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    dialog#image-title-dialog::backdrop {
      background: rgba(0, 0, 0, 0.3);
    }

    dialog#image-title-dialog form {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    dialog#image-title-dialog label {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.9rem;
      color: #333;
    }

    dialog#image-title-dialog input[type="text"] {
      padding: 6px 8px;
      font-size: 0.85rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    dialog#image-title-dialog fieldset {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    dialog#image-title-dialog button {
      padding: 6px 12px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    dialog#image-title-dialog .dialog-actions {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .indent-option {
      padding: 6px 10px;
      font-size: 0.85rem;
    }

    .indent-option label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .indent-option input:disabled+span {
      color: #999;
    }

    /* ぶら下げインデント: インデントなしの場合は1文字戻し */
    .page-inner .hanging-indent {
      text-indent: -1em;
    }

    /* 
       インデントがある場合のぶら下げ:
       パディングを維持しつつ、text-indent で1行目を左端(0pt)に戻す。
       念のため padding-left も明示してインデント消失を防ぐ。
    */
    .page-inner .indent-1.hanging-indent {
      padding-left: 36pt;
      text-indent: -36pt;
    }

    .page-inner .indent-2.hanging-indent {
      padding-left: 72pt;
      text-indent: -72pt;
    }

    .page-inner .indent-3.hanging-indent {
      padding-left: 108pt;
      text-indent: -108pt;
    }

    .page-inner .indent-4.hanging-indent {
      padding-left: 144pt;
      text-indent: -144pt;
    }

    .page-inner .indent-5.hanging-indent {
      padding-left: 180pt;
      text-indent: -180pt;
    }
  </style>
</head>

<body>

  <div id="left">
    <div id="toolbar">
      <div class="file-menu">
        <button type="button" class="file-trigger">File ▾</button>
        <div class="file-dropdown" role="menu" aria-label="File options">
          <button type="button" data-action="save">Save</button>
          <button type="button" data-action="open">Open</button>
          <button type="button" data-action="overwrite">Overwrite</button>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">ハイパーリンク</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="add-link-destination">リンク先に追加</button>
              <button type="button" data-action="create-link">リンクを生成</button>
              <button type="button" data-action="remove-link">リンクを削除</button>
            </div>
          </div>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">Insert
              Image</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="insert-image-dropbox">dropboxから挿入</button>
              <button type="button" data-action="insert-image-web">web上の画像を挿入</button>
            </div>
          </div>
          <div class="nested-dropdown">
            <button type="button" class="nested-trigger" aria-haspopup="menu" aria-expanded="false">余白</button>
            <div class="nested-dropdown-menu" role="menu">
              <button type="button" data-action="page-margin" data-size="s">S</button>
              <button type="button" data-action="page-margin" data-size="m">M</button>
              <button type="button" data-action="page-margin" data-size="l">L</button>
            </div>
          </div>
        </div>
      </div>
      <button type="button" data-action="bold">B</button>
      <button type="button" data-action="italic">I</button>
      <button type="button" data-action="underline">U</button>
      <button type="button" data-action="strike">S</button>
      <div class="highlight-control">
        <button type="button" data-action="highlight" aria-expanded="false">HL</button>
        <div class="highlight-palette" role="group" aria-label="ハイライトカラー">
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#FFFF00"
            style="color:#FFFF00" title="黄色" aria-label="黄色"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#FFB7B7"
            style="color:#FFB7B7" title="薄ピンク" aria-label="薄ピンク"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#B7E1FF"
            style="color:#B7E1FF" title="薄青" aria-label="薄青"></button>
          <button type="button" class="highlight-color-button" data-action="highlight-color" data-color="#C4F0C5"
            style="color:#C4F0C5" title="薄緑" aria-label="薄緑"></button>
          <button type="button" class="highlight-reset-button" data-action="highlight-reset"
            title="ハイライトを取り消す">取消</button>
        </div>
      </div>
      <button type="button" data-action="superscript">上付き</button>
      <button type="button" data-action="subscript">下付き</button>
      <div class="font-chooser" id="font-chooser">
        <button type="button" class="font-chooser-trigger" aria-haspopup="true" aria-expanded="false">Font ▾</button>
        <div class="font-chooser-panel" role="menu" aria-label="フォント操作">
          <div class="font-submenu" data-submenu="block-element">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">ブロック要素</button>
            <div class="font-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h1"
                  title="見出し１">見出し１</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h2"
                  title="見出し２">見出し２</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="h3"
                  title="見出し３">見出し３</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="p"
                  title="本文">本文</button>
                <button type="button" class="spacing-button" data-action="block-element" data-tag="mini-p"
                  title="サブテキスト">サブテキスト</button>
              </div>
            </div>
          </div>
          <div class="font-submenu" data-submenu="font-color">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">フォントカラー</button>
            <div class="font-submenu-panel" role="menu">
              <div class="color-palette" role="group" aria-label="フォントカラー">
                <button type="button" class="color-default-button" data-action="font-color-default" title="デフォルトカラー"
                  aria-label="デフォルトカラー">デフォルト</button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#D92C2C"
                  style="color:#D92C2C" title="#D92C2C" aria-label="#D92C2C"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#E67F22"
                  style="color:#E67F22" title="#E67F22" aria-label="#E67F22"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#2E86C1"
                  style="color:#2E86C1" title="#2E86C1" aria-label="#2E86C1"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#1F618D"
                  style="color:#1F618D" title="#1F618D" aria-label="#1F618D"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#17A589"
                  style="color:#17A589" title="#17A589" aria-label="#17A589"></button>
                <button type="button" class="color-swatch-button" data-action="font-color-swatch" data-color="#7D3C98"
                  style="color:#7D3C98" title="#7D3C98" aria-label="#7D3C98"></button>
              </div>
            </div>
          </div>
          <div class="font-submenu" data-submenu="font-family">
            <button type="button" class="font-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">フォントファミリー</button>
            <div class="font-submenu-panel" role="menu">
              <div class="font-family-list">
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Yu Gothic', '游ゴシック体', sans-serif">游ゴシック / Yu Gothic</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Yu Mincho', '游明朝', serif">游明朝 / Yu Mincho</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Meiryo', 'メイリオ', sans-serif">メイリオ / Meiryo</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Hiragino Kaku Gothic ProN', 'ヒラギノ角ゴ ProN', sans-serif">Hiragino Sans / ヒラギノ角ゴ</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Hiragino Mincho ProN', 'ヒラギノ明朝 ProN', serif">Hiragino Mincho / ヒラギノ明朝</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Noto Sans JP', sans-serif">Noto Sans JP</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Noto Serif JP', serif">Noto Serif JP</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Arial', sans-serif">Arial</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Times New Roman', serif">Times New Roman</button>
                <button type="button" class="font-family-option" data-action="font-family"
                  data-family="'Courier New', monospace">Courier New</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="paragraph-chooser" id="paragraph-chooser">
        <button type="button" class="paragraph-trigger" aria-haspopup="true" aria-expanded="false">段落スタイル</button>
        <div class="paragraph-panel" role="menu" aria-label="段落スタイル">
          <div class="paragraph-submenu" data-submenu="align">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">Align</button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="align-buttons">
                <button type="button" class="align-icon-button" data-action="align-left" title="左揃え"
                  aria-label="左揃え">左</button>
                <button type="button" class="align-icon-button" data-action="align-center" title="中央揃え"
                  aria-label="中央揃え">中</button>
                <button type="button" class="align-icon-button" data-action="align-right" title="右揃え"
                  aria-label="右揃え">右</button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="spacing">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">段落下の余白</button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="xs"
                  title="XS">XS</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="s"
                  title="S">S</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="m"
                  title="M">M</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="l"
                  title="L">L</button>
                <button type="button" class="spacing-button" data-action="paragraph-spacing" data-size="xl"
                  title="XL">XL</button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="line-height">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">行間</button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="line-height" data-size="s"
                  title="S">S</button>
                <button type="button" class="spacing-button" data-action="line-height" data-size="m"
                  title="M">M</button>
                <button type="button" class="spacing-button" data-action="line-height" data-size="l"
                  title="L">L</button>
              </div>
            </div>
          </div>
          <div class="paragraph-submenu" data-submenu="indent">
            <button type="button" class="paragraph-submenu-trigger" aria-haspopup="true"
              aria-expanded="false">インデント</button>
            <div class="paragraph-submenu-panel" role="menu">
              <div class="spacing-buttons">
                <button type="button" class="spacing-button" data-action="indent">インデント＋</button>
                <button type="button" class="spacing-button" data-action="outdent">インデントー</button>
              </div>
              <div class="indent-option">
                <label>
                  <input type="checkbox" data-action="hanging-indent" disabled> ぶら下げ
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
      <button type="button" data-action="add-page">+Page</button>
      <button type="button" data-action="remove-page">-Page</button>
    </div>
    <input type="file" id="open-file-input" accept=".html,text/html" style="display:none" />
    <div id="pages-container">
      <!-- 初期ページ -->
      <section class="page" data-page="1">
        <div class="page-inner" contenteditable="true">
          <p>ここに本文を書く</p>
        </div>
      </section>
      <div id="ai-image-index" style="display:none"></div>
    </div>
  </div>

  <textarea id="source" readonly></textarea>
  <div id="image-context-menu" class="image-context-menu" role="menu">
    <div class="image-context-dropdown">
      <button type="button" class="image-context-trigger" aria-haspopup="menu" aria-expanded="false">サイズ</button>
      <div class="image-context-submenu" role="menu">
        <button type="button" data-action="image-size" data-size="xs">XS</button>
        <button type="button" data-action="image-size" data-size="s">S</button>
        <button type="button" data-action="image-size" data-size="m">M</button>
        <button type="button" data-action="image-size" data-size="l">L</button>
        <button type="button" data-action="image-size" data-size="xl">XL</button>
      </div>
    </div>
    <button type="button" data-action="image-border">枠線</button>
    <button type="button" data-action="image-title">タイトル</button>
    <button type="button" data-action="image-caption">キャプション</button>
    <button type="button" data-action="image-tag">タグ</button>
  </div>

  <dialog id="image-title-dialog" aria-labelledby="image-title-dialog-label">
    <form method="dialog" aria-describedby="image-title-dialog-description">
      <p id="image-title-dialog-label">画像タイトル</p>
      <label for="image-title-input">
        タイトル
        <input type="text" id="image-title-input" name="image-title-input" placeholder="タイトルを入力" />
      </label>
      <fieldset id="image-title-dialog-description">
        <legend>フォントサイズ</legend>
        <label>
          <input type="radio" name="image-title-font-size" value="default" checked />
          標準
        </label>
        <label>
          <input type="radio" name="image-title-font-size" value="mini" />
          小サイズ (mini-p)
        </label>
      </fieldset>
      <div class="dialog-actions">
        <button type="button" data-action="cancel-image-title">キャンセル</button>
        <button type="button" data-action="apply-image-title">適用</button>
      </div>
    </form>
  </dialog>



  <script type="module">
    import { initEditor } from "./dist/main.js";
    initEditor();
  </script>


</body>

</html>